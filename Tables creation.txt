
-- STAGE Table
SELECT COUNT(*) FROM SCD_DB.PROJECT_DB.CUSTOMER_RAW;
SELECT * FROM SCD_DB.PROJECT_DB.CUSTOMER_RAW;
SELECT DISTINCT INGESTED_TIME FROM SCD_DB.PROJECT_DB.CUSTOMER_RAW;

TRUNCATE SCD_DB.PROJECT_DB.CUSTOMER_RAW;


--- DIM CUSTOMER (SCD1 Table)
create or replace TABLE SCD_DB.PROJECT_DB.DIM_CUSTOMER(
	ID NUMBER(38,0),
	FIRST_NAME VARCHAR(200),
	LAST_NAME VARCHAR(200),
	STREET_NAME VARCHAR(200),
	CITY VARCHAR(200),
	STATE VARCHAR(200),
	ZIP_CODE NUMBER(38,0),
	COUNTRY VARCHAR(200),
	JOB VARCHAR(200),
	EMAIL VARCHAR(200),
	PHONE_NUMBER VARCHAR(200),
    UPDATE_TIMESTAMP TIMESTAMP 
);


--- DIM_CUSTOMER_HIST (SCD2 Table)
create or replace TABLE SCD_DB.PROJECT_DB.DIM_CUSTOMER_HIST (
	ID NUMBER(38,0),
	FIRST_NAME VARCHAR(200),
	LAST_NAME VARCHAR(200),
	STREET_NAME VARCHAR(200),
	CITY VARCHAR(200),
	STATE VARCHAR(200),
	ZIP_CODE NUMBER(38,0),
	COUNTRY VARCHAR(200),
	JOB VARCHAR(200),
	EMAIL VARCHAR(200),
	PHONE_NUMBER VARCHAR(200),
    IS_ACTIVE VARCHAR(200),
    START_TIME TIMESTAMP,
    END_TIME TIMESTAMP
);
